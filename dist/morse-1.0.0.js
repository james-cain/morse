!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Morse=e()}(this,function(){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t},t=function(){function s(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,e,i){return e&&s(t.prototype,e),i&&s(t,i),t}}();return function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=i({el:"body",code:"___",duration:400,timeout:2e3,tapEvent:!1,matching:function(){},matched:function(){},unmatched:function(){},onTimeout:function(){}},t),this.el=document.querySelector(this.options.el),this.timer=null,this.tapStartEvent=this.options.tapEvent?"touchstart":"mousedown",this.tapEndEvent=this.options.tapEvent?"touchend":"mouseup",this.tapStart=0,this.tapTime=0,this.tapStartX=0,this.tapStartY=0,this.distanceX=0,this.distanceY=0,this.slideDistance=0,this.morseCode=[],this.isTimeout=!1,this._addListener()}return t(e,[{key:"_addListener",value:function(){var e=this;this._registTapStartEvent=function(t){e._registTapStartFunc(t)},this._registTapEndEvent=function(t){e._registTapEndFunc(t)},this.el.addEventListener(this.tapStartEvent,this._registTapStartEvent),this.el.addEventListener(this.tapEndEvent,this._registTapEndEvent)}},{key:"_startTimer",value:function(){var t=this;this.timer=setTimeout(function(){t.isTimeout=!0,t._reset(),t.options.onTimeout()},this.options.timeout)}},{key:"_stopTimer",value:function(){clearTimeout(this.timer)}},{key:"_matchCode",value:function(t){var e=this.options.code,i=t.join("");i===e?(this.options.matched(),this._reset()):i.length===e.length&&i!==e&&(this.options.unmatched(),this._reset())}},{key:"_reset",value:function(){this.morseCode=[],this.isTimeout=!1,this.tapStart=0,this.tapTime=0,this.tapStartX=0,this.tapStartY=0,this.distanceX=0,this.distanceY=0,this.slideDistance=0}},{key:"_registTapStartFunc",value:function(t){this._stopTimer(),this.tapStart=(new Date).getTime(),this.tapStartX=t.x,this.tapStartY=t.y}},{key:"_registTapEndFunc",value:function(t){this.tapTime=(new Date).getTime()-this.tapStart,this.distanceX=t.x-this.tapStartX,this.distanceY=t.y-this.tapStartY,this.isTimeout?this._reset():(this._transformCode(),this.options.matching(this.morseCode),this._matchCode(this.morseCode),this._startTimer())}},{key:"_transformCode",value:function(){var t=Math.abs(this.distanceX),e=Math.abs(this.distanceY);10<t||10<e?e<=t?0<this.distanceX?this.morseCode.push("R"):this.morseCode.push("L"):0<this.distanceY?this.morseCode.push("D"):this.morseCode.push("U"):this.tapTime<this.options.duration?this.morseCode.push("_"):this.morseCode.push("-")}},{key:"removeListener",value:function(){this.el.removeEventListener(this.tapStartEvent,this._registTapStartEvent),this.el.removeEventListener(this.tapEndEvent,this._registTapEndEvent)}}]),e}()});
